<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.boot.commu.mapper.UserMapper">

	<select id="login" parameterType="map" resultType="users">
		select * from a_users where email = #{email} and password = #{password} and state = 'Y'
	</select>
	
	<select id="chkId" parameterType="String" resultType="int">
		select count(*) from a_users where email = #{email} and state = 'Y'
	</select>
	
	<select id="chkPhone" parameterType="String" resultType="int">
		select count(*) from a_users where phone = #{phone} and state = 'Y'
	</select>
	
	<select id="chkNickname" parameterType="String" resultType="int">
		select count(*) from a_users where nickname = #{nickname} and state = 'Y'
	</select>
	
	<insert id="addUser" parameterType="users">
		<selectKey resultType="int" keyProperty="id" order="BEFORE">
			select max(id) from a_users
		</selectKey>
		insert into a_users values(#{id} + 1, #{email}, #{password}, #{phone}, 
		#{name}, #{nickname}, default, default, sysdate, '')
	</insert>
	
</mapper>